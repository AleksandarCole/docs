


## Overview

This documentation page will demonstrate the use of secrets in Semaphore 2.0
projects.

## Quick start

In this section you will learn how to work with secrets on your Semaphore 2.0
projects with the help of the `sem` command line utility.

In order to follow this page you will need to have the `sem`
utility installed on your machine. You can download `sem` by following
these [instructions]().


## How to use sem

The `sem` commands for working with secrets are the following:

* `sem create -f aFile.yml`: creates a new secret
* `sem get secrets`: for listing existing secrets
* `sem describe secrets <secret bucket>`: for listing the contents of an
    existing secret
* `sem delete secrets <secret bucket>`: for deleting an existing secret

You will see all these commands in action in a while.

### Examples

This section will present some everyday `sem` commands that can help you work
with secrets as well as a Semaphore pipeline YAML file that uses an existing
secret.




The pipeline YAML file that uses secrets is the following:



So, what is happening here?



## The process in more detail

The process of creating and using a secret involves the following steps:

* Creating a secrets YAML file
* Importing that secrets YAML file to Semaphore using `sem`
* Using the secret you have just create in a Semaphore project

### YAML file for creating secrets

Everything that is related with secrets starts from a YAML file that is
specific to secrets and allows you to create new secrets under the current
organization. For the purposes of this documentation page, the YAML file that
is going to be used is named `createSecret.yml` and has the following content:

    $ cat createSecret.yml
    apiVersion: v1alpha
    kind: Secret
    metadata:
      name: my-secrets
    data:
      env_vars:
        - name: SECRET_ONE
          value: "Ca c'est un petite secret"
        - name: SECRET_TWO
          value: "Secret deux"

Each secrets YAML file creates a new `secrets` bucket, which is a place for
storing secrets, that can contain one or more secrets. You recall a `secrets`
bucket on your Semaphore project by its name.

Have in mind that each `secrets` bucket is stored under a Semaphore
organization and that in order to use a particular `secrets` bucket you should
be connected to its related organization.

You can now import that secret YAML file into Semaphore by executing the
following command:

    sem create -f createSecret.yml

### How to tie an existing secret into a pipeline quickly

If you know that name of a secret, you can quickly add its contents to a
Semaphore project by including the following into a pipeline YAML file:


### Showing existing secrets

Getting a list of the secrets that exist under the active organization requires
the execution of the next command:

    sem get secrets

### Showing the contents of an existing secret

You can see the contents of an existing secret as follows:

    sem describe secrets my-secrets

The following command can help you get the contents of all the secrets of the
current organization:

    sem get secrets | grep -v NAME | xargs -n1 sem describe secrets

### Updating existing secrets (to be defined)

Updating existing secrets can be also done with the `sem` utility.


### Deleting a secret

Deleting an existing secret along with its contents is as simple as executing
the following command:

    sem delete secrets my-secrets

The only way to recreate a secret that you deleted is to find the secret YAML
file of that secret and execute `sem create`.

## Use cases


### How to handle a ssh key (connect to remote server)

In this section you will learn how to store and retrieve ssh keys as secrets
in order to connect to a remote SSH server or exchange files securely using
SFTP.



### How to store something into S3 bucket -  AWS key&secret  <= env vars


### Store credentials for accessing docker registry (AWS - env vars, Google - file <= we need file support first)


### Connecting to k8s cluster (Google - file <= we need file support first)


## See also

* [Download sem]()
* [Secrets YAML reference](https://docs.semaphoreci.com/article/51-secrets-yaml-reference)
* [sem command line tool reference](https://docs.semaphoreci.com/article/53-sem-reference)
* [Projects YAML reference](https://docs.semaphoreci.com/article/52-projects-yaml-reference)
* [Pipeline YAML Reference](https://docs.semaphoreci.com/article/50-pipeline-yaml)
* [Changing Organizations](https://docs.semaphoreci.com/article/29-changing-organizations)
